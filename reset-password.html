<!-- reset-password.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>
<style>
  body { font-family: Arial; display: flex; justify-content: center; padding: 40px; }
  .card { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 3px 8px rgba(0,0,0,0.08); max-width: 400px; width: 100%; }
  input { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #ccc; }
  button { width: 100%; padding: 12px; background: #4caf50; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
  button:hover { background: #388e3c; }
  a { display: block; margin-top: 10px; text-decoration: none; color: #4caf50; }
</style>
</head>
<body>
<div class="card">
  <h2>Reset Password</h2>
  <input type="text" id="username" placeholder="Username">
  <button id="resetBtn">Send Reset Link</button>
  <p id="statusMsg"></p>
  <a href="index.html">Back to Login</a>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

const firebaseConfig = { apiKey:"AIzaSyCu0Ztd-n7hfruykfYI8jenMf5eIKKeZcE", authDomain:"burnoligithub.firebaseapp.com", projectId:"burnoligithub", storageBucket:"burnoligithub.firebasestorage.app", messagingSenderId:"973403605126", appId:"1:973403605126:web:992fdf57408a2f45426907", measurementId:"G-GWWXBJYSFE"};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const usernameInput = document.getElementById('username');
const resetBtn = document.getElementById('resetBtn');
const statusMsg = document.getElementById('statusMsg');

resetBtn.addEventListener('click', async () => {
  const username = usernameInput.value.trim().toLowerCase();
  if (!username) { statusMsg.textContent = "Enter your username"; return; }
  try {
    const usernameDoc = await getDoc(doc(db, "usernames", username));
    if (!usernameDoc.exists()) return statusMsg.textContent = "❌ Username not found";
    const uid = usernameDoc.data().uid;
    const userDoc = await getDoc(doc(db, "users", uid));
    if (!userDoc.exists() || !userDoc.data().realEmail) return statusMsg.textContent = "❌ No email on file";
    await sendPasswordResetEmail(auth, userDoc.data().realEmail);
    statusMsg.textContent = `✅ Reset link sent to ${userDoc.data().realEmail}`;
  } catch (err) { statusMsg.textContent = "❌ Error: " + err.message; }
});
</script>
</body>
</html>
